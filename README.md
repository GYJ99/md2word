# md2word

Go è¯­è¨€å®ç°çš„ Markdown è½¬ DOCX å·¥å…·ï¼Œæ”¯æŒæµç¨‹å›¾ã€å›¾ç‰‡ã€è¡¨æ ¼ã€å…¬å¼ç­‰ä¸°å¯Œå†…å®¹ï¼Œä¸“ä¸ºä¸­æ–‡æ’ç‰ˆä¼˜åŒ–ã€‚

## âœ¨ ç‰¹æ€§

- ğŸ¯ **å®Œæ•´ Markdown æ”¯æŒ**ï¼šæ ‡é¢˜ã€åˆ—è¡¨ã€è¡¨æ ¼ã€ä»£ç å—ã€å¼•ç”¨ç­‰
- ğŸ“Š **Mermaid æµç¨‹å›¾**ï¼šä½¿ç”¨ chromedp ç¦»çº¿æ¸²æŸ“ï¼Œæ— éœ€å¤–éƒ¨å·¥å…·
- ğŸ§® **æ•°å­¦å…¬å¼**ï¼šMathJax æ¸²æŸ“ä¸ºé«˜æ¸…å›¾ç‰‡
- ğŸ–¼ï¸ **æ™ºèƒ½å›¾ç‰‡å¤„ç†**ï¼šæ”¯æŒæœ¬åœ°/ç½‘ç»œ/Base64 å›¾ç‰‡ï¼Œè‡ªåŠ¨æ ¼å¼æ£€æµ‹
- ğŸ”— **åŸç”Ÿè¶…é“¾æ¥**ï¼šç”Ÿæˆå¯ç‚¹å‡»çš„ Word è¶…é“¾æ¥
- ğŸ¨ **çµæ´»æ ·å¼é…ç½®**ï¼šé€šè¿‡ YAML æ–‡ä»¶è‡ªå®šä¹‰å­—ä½“ã€å­—å·ã€è¡Œè·ã€ç¼©è¿›
- ğŸ“ **ä¸­æ–‡æ’ç‰ˆä¼˜åŒ–**ï¼šé»˜è®¤å®‹ä½“æ­£æ–‡ã€é»‘ä½“æ ‡é¢˜ï¼Œæ”¯æŒé¦–è¡Œç¼©è¿›
- ğŸš€ **å¼€ç®±å³ç”¨**ï¼šé…ç½®å†…åµŒäºäºŒè¿›åˆ¶ï¼Œå•æ–‡ä»¶å³å¯è¿è¡Œ

## ğŸ“¦ å®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/GYJ99/md2word.git
cd md2word

# æ„å»º
go build -o md2word ./cmd/md2word

# å®‰è£…åˆ° $GOPATH/bin
go install ./cmd/md2word
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ç”¨æ³•

```bash
md2word -i input.md -o output.docx
```

### ä½¿ç”¨è‡ªå®šä¹‰é…ç½®

```bash
md2word -i input.md -o output.docx -c config.yaml
```

### å‘½ä»¤è¡Œå‚æ•°

| å‚æ•° | è¯´æ˜ |
|------|------|
| `-i, --input` | è¾“å…¥ Markdown æ–‡ä»¶è·¯å¾„ï¼ˆå¿…éœ€ï¼‰ |
| `-o, --output` | è¾“å‡º DOCX æ–‡ä»¶è·¯å¾„ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸è¾“å…¥åŒåï¼‰ |
| `-c, --config` | é…ç½®æ–‡ä»¶è·¯å¾„ï¼ˆå¯é€‰ï¼‰ |

### é…ç½®åŠ è½½ä¼˜å…ˆçº§

ç¨‹åºæŒ‰ä»¥ä¸‹é¡ºåºæŸ¥æ‰¾é…ç½®æ–‡ä»¶ï¼š
1. **å‘½ä»¤è¡Œå‚æ•°** `-c config.yaml`
2. **å½“å‰ç›®å½•** `./config.yaml`
3. **å®‰è£…ç›®å½•** `$EXE_DIR/config.yaml`
4. **å†…ç½®é»˜è®¤** ç¼–è¯‘æ—¶åµŒå…¥çš„é…ç½®

## âš™ï¸ é…ç½®æ–‡ä»¶

é…ç½®æ–‡ä»¶ä½¿ç”¨ YAML æ ¼å¼ï¼Œæ”¯æŒä¸°å¯Œçš„æ ·å¼å®šåˆ¶ï¼š

```yaml
# æ ·å¼é…ç½®
styles:
  body:
    font: "å®‹ä½“"
    size: 10.5           # äº”å·å­—
    lineHeight: 360      # 1.5å€è¡Œè· (twips, 240=å•å€)
    firstLineIndent: 420 # é¦–è¡Œç¼©è¿› (twips, çº¦2å­—ç¬¦)

  heading1:
    font: "é»‘ä½“"
    size: 16             # ä¸‰å·å­—
    bold: true

  code:
    font: "Consolas"
    size: 8
    background: "#f5f5f5"

# è¡¨æ ¼é…ç½®
table:
  font: "å®‹ä½“"
  size: 10.5
  borders: true
  headerBold: true

# Mermaid æµç¨‹å›¾
mermaid:
  enabled: true
  theme: "default"

# æ•°å­¦å…¬å¼
math:
  enabled: true
  render: "image"

# å›¾ç‰‡é…ç½®
images:
  maxWidth: 600
  downloadTimeout: 30
```

### å•ä½è¯´æ˜

- **å­—å· (size)**ï¼šptï¼ˆç£…ï¼‰
- **é—´è·/è¡Œé«˜/ç¼©è¿›**ï¼štwipsï¼ˆ1/20 ç£…ï¼‰
  - `240` twips = 12pt = å•å€è¡Œè·
  - `360` twips = 18pt = 1.5å€è¡Œè·
  - `420` twips â‰ˆ 2å­—ç¬¦é¦–è¡Œç¼©è¿›ï¼ˆåŸºäºäº”å·å­—ï¼‰

## ğŸ“‹ é»˜è®¤æ ·å¼

| å…ƒç´  | å­—ä½“ | å­—å· | è¯´æ˜ |
|------|------|------|------|
| æ­£æ–‡ | å®‹ä½“ | 10.5pt (äº”å·) | 1.5å€è¡Œè·ï¼Œé¦–è¡Œç¼©è¿›2å­—ç¬¦ |
| ä¸€çº§æ ‡é¢˜ | é»‘ä½“ | 16pt (ä¸‰å·) | åŠ ç²— |
| äºŒçº§æ ‡é¢˜ | é»‘ä½“ | 15pt (å°ä¸‰) | åŠ ç²— |
| ä¸‰çº§æ ‡é¢˜ | é»‘ä½“ | 15pt (å°ä¸‰) | åŠ ç²— |
| å››-ä¹çº§æ ‡é¢˜ | é»‘ä½“ | 14pt (å››å·) | åŠ ç²— |
| ä»£ç å— | Consolas | 8pt | æµ…ç°èƒŒæ™¯ |

## ğŸ› ï¸ ç¯å¢ƒè¦æ±‚

### å¿…éœ€

- **Go 1.18+**ï¼šç”¨äºç¼–è¯‘æ„å»º
- **Chrome/Chromium æµè§ˆå™¨**ï¼šç”¨äº Mermaid æµç¨‹å›¾æ¸²æŸ“ï¼ˆä½¿ç”¨ chromedpï¼‰

### å®‰è£… Chrome (macOS)

```bash
brew install --cask google-chrome
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
md2word/
â”œâ”€â”€ cmd/md2word/           # CLI å…¥å£
â”‚   â””â”€â”€ main.go
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ config/            # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ config.go
â”‚   â”‚   â””â”€â”€ default.yaml   # å†…åµŒé»˜è®¤é…ç½®
â”‚   â”œâ”€â”€ converter/         # æ ¸å¿ƒè½¬æ¢å™¨
â”‚   â”‚   â”œâ”€â”€ converter.go   # ä¸»è½¬æ¢é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ code_native.go # ä»£ç é«˜äº®
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ docx/              # DOCX ç”Ÿæˆ
â”‚   â”‚   â”œâ”€â”€ document.go    # æ–‡æ¡£ç»“æ„
â”‚   â”‚   â”œâ”€â”€ paragraph.go   # æ®µè½/è¶…é“¾æ¥
â”‚   â”‚   â”œâ”€â”€ table.go       # è¡¨æ ¼å…ƒç´ 
â”‚   â”‚   â””â”€â”€ styles.go      # æ ·å¼å®šä¹‰
â”‚   â””â”€â”€ parser/            # Markdown è§£æ
â”œâ”€â”€ config.yaml            # ç¤ºä¾‹é…ç½®
â”œâ”€â”€ test/                  # æµ‹è¯•æ–‡ä»¶
â”‚   â””â”€â”€ sample.md
â””â”€â”€ README.md
```

## ğŸ”§ å¼€å‘

### æ„å»º

```bash
go build -o md2word ./cmd/md2word
```

### æµ‹è¯•

```bash
go test ./...
```

### è¿è¡Œç¤ºä¾‹

```bash
./md2word -i test/sample.md -o test/output.docx
```

## ğŸ“ æ”¯æŒçš„ Markdown è¯­æ³•

- [âœ…] æ ‡é¢˜ (1-9çº§)
- [âœ…] æ®µè½å’Œæ–‡æœ¬æ ¼å¼ (åŠ ç²—ã€æ–œä½“ã€åˆ é™¤çº¿)
- [âœ…] æœ‰åº/æ— åºåˆ—è¡¨
- [âœ…] è¡¨æ ¼ (GFM æ ¼å¼)
- [âœ…] ä»£ç å— (è¯­æ³•é«˜äº®)
- [âœ…] è¡Œå†…ä»£ç 
- [âœ…] è¶…é“¾æ¥
- [âœ…] å›¾ç‰‡ (æœ¬åœ°/ç½‘ç»œ/Base64)
- [âœ…] å¼•ç”¨å—
- [âœ…] åˆ†éš”çº¿
- [âœ…] Mermaid æµç¨‹å›¾
- [âœ…] æ•°å­¦å…¬å¼ ($...$, $$...$$)

## ğŸ“„ License

MIT License
